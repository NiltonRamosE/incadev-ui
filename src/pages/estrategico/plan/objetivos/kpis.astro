---
import KpiPage from "@/process/strategic/dashboard/plan/KpiPage";
import PlanLayout from "@/process/strategic/layouts/PlanLayout.astro";
import '@/styles/global.css';

const title = "Dashboard Gestion de Planes | INCADEV Estrategico";
const description = "Panel de control de los planes";
const robots = ["noindex", "nofollow"];
const keywords = ["INCADEV", "estrategico", "administración", "dashboard", "gestión"];
const url = "https://instituto.cetivirgendelapuerta.com/estrategico";
const imageOG = "/ISOLOGOTIPO_VERTICAL.svg";
const imagetwt = "/ISOLOGOTIPO_VERTICAL.svg";

const urlParams = new URLSearchParams(Astro.request.url.split("?")[1]);
const planId = Number(urlParams.get("planId")) || 0;
const objetivoId = Number(urlParams.get("id")) || 0;

// Datos simulados
const planes = [
  { id: 1, nombre: "Plan Estratégico 2025" },
  { id: 2, nombre: "Plan Estratégico 2026" },
];
const objetivos = [
  { id: 1, nombre: "Optimizar procesos académicos" },
  { id: 2, nombre: "Incrementar la satisfacción estudiantil" },
];

//Se busca el plan mediante el id de la url
const plan = planes.find((p) => p.id === planId);

//Se busca el objetivo mediante el id url
const objetivo = objetivos.find((o) => o.id === objetivoId);

//Se busca todos los kpi del objetivo
const kpis = [
  { id: 1, nombre: "Tasa de retención estudiantil" },
  { id: 2, nombre: "Índice de satisfacción del alumno" },
];

//Si bien parece repetitivo realizar nuevamente las peticiones al plan y objetivo por cada pagina, en si es para mantener
// el "indice interactuable" = Inicio > Plan > Objetivo > Kpi
// no se pueden pasar objetos entre pagina entonces solo queda hacer esto, y si no quieren hacer esas peticiones que estan
// de mas, entonces solo se usa el id de la url para buscar unicamente el objetivo o kpi requerido

---
<PlanLayout {robots} {title} {description} {keywords} {url} {imageOG} {imagetwt}>
<KpiPage client:load plan={plan} objetivo={objetivo} kpis={kpis}/>
<PlanLayout />